<script>
  async function loadMeals() {
    try {
      const response = await fetch("meals.json");
      const meals = await response.json();

      const toggles = document.querySelectorAll(".person-toggle input");
      const resultsDiv = document.getElementById("results");

      function filterMeals() {
        const selected = Array.from(toggles)
          .filter(t => t.checked)
          .map(t => t.value);

        const filtered = meals.filter(m =>
          selected.every(person => m.likedBy.includes(person))
        );

        resultsDiv.innerHTML = "";
        if (filtered.length > 0) {
          const ul = document.createElement("ul");
          filtered.forEach(m => {
            const li = document.createElement("li");
            li.textContent = m.meal;
            ul.appendChild(li);
          });
          resultsDiv.appendChild(ul);
        } else {
          resultsDiv.textContent = "No meals found.";
        }
      }

      toggles.forEach(t => t.addEventListener("change", filterMeals));
      filterMeals();
    } catch (err) {
      console.error("Error loading meals:", err);
    }
  }

  loadMeals();
</script>

